<div class="main">

  <mat-card class="card">
    <div class="content">
      <div>
      </div>
      <div style="padding: 25px; display: flex; flex-direction: column; align-items: center;">
        <div style="width: 180px; height: 180px; background-image: url({{profileImg}}); background-size: cover; border-radius: 50%;"></div>
        <h3>{{userName}} {{ userName | fruits }}</h3>

      </div>

      <div style="padding: 25px 25px;">

        <mat-accordion>
          <mat-expansion-panel hideToggle>
            <mat-expansion-panel-header>
              <mat-panel-title>Conta</mat-panel-title>
              <mat-panel-description>Sobre a conta</mat-panel-description>
            </mat-expansion-panel-header>
            <p>Nome: {{userName}}</p>
          </mat-expansion-panel>

          <mat-expansion-panel (opened)="panelOpenState.set(true)" (closed)="panelOpenState.set(false)">
            <mat-expansion-panel-header>
              <mat-panel-title>Meu anúncio</mat-panel-title>
              <mat-panel-description>
                Sobre minha vianda
              </mat-panel-description>
            </mat-expansion-panel-header>

            @if(isEditing){
            <app-vianda-crud (save)="updateVianda($event)" [initialData]="vianda"></app-vianda-crud>
            <div class="group-buttons" style="text-align: center; padding: 10px 10px;">
              <button (click)="editVianda()" mat-stroked-button>
                Voltar
                <mat-icon>arrow_back</mat-icon>
              </button>
            </div>
            }

            @if (viandaAvailable && !isEditing) {
            <div name="info-vianda">
              <div>
                <p>Nome da vianda: {{vianda.nomevianda}}</p>
                <p>Cidade: {{vianda.cidade}}</p>
                <p>Bairro: {{vianda.bairro}}</p>
                <p>Cep: {{vianda.cep}}</p>
                <p>Cardápio: {{vianda.cardapio}}</p>
                <p>Whatsapp: {{vianda.whatsapp}}</p>
              </div>
              <div>
                <div class="group-buttons" style="text-align: center; padding: 10px 10px;">
                  <button (click)="removeVianda(vianda.userid)" mat-stroked-button>
                    Remover
                    <mat-icon>delete_forever</mat-icon>
                  </button>
                  <button (click)="editVianda()" mat-stroked-button>
                    Editar
                    <mat-icon>edit</mat-icon>
                  </button>
                </div>
              </div>
            </div>
            }

            @if(!viandaAvailable && !isEditing){
            <div>
              <app-vianda-crud (save)="handleSave($event)"></app-vianda-crud>
            </div>
            }

          </mat-expansion-panel>

          <mat-expansion-panel (opened)="panelOpenState.set(true)" (closed)="panelOpenState.set(false)">
            <mat-expansion-panel-header>
              <mat-panel-title>Configuração</mat-panel-title>
              <mat-panel-description>
              </mat-panel-description>
            </mat-expansion-panel-header>
            <button (click)="logOut()" mat-button>Deslogar</button>
          </mat-expansion-panel>

        </mat-accordion>

      </div>
    </div>
  </mat-card>

</div>


